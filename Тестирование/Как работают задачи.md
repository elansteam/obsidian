## Базовые определения
**Задача** - собственно, задача.

**Условия задачи** - [MDX](https://mdxjs.com/) файлы. Формат MDX является расширением Markdown, добавляющим поддержку JSX-компонентов, которые могут использоваться для создания интерактивных примеров в условиях. Этот формат поддерживает Markdown, Latex и JSX.
Список файлов условия для конкретного языка (например, русского):
- `input.mdx` - формат входных данных **(обязательный файл)**
- `output.mdx` - формат выходных данных **(обязательный файл)**
- `legend.mdx` - легенда задачи (первые абзацы условия до описания входных данных)
- `name.mdx` - имя задачи **(обязательный файл)**
- `notes.mdx` - примечания
- `scoring.mdx` - система оценки
- `tutorial.mdx` - решение задачи
Также в условия включена папка `examples`, в которой находятся примеры тестов. Каждый тест имеет 2 файла - файл входных данных (имя - его порядковый номер без ведущих нулей) и файл выходных данных (имя - его порядковый номер без ведущих нулей с расширением ".a").
Условия могут быть на разных языках, условия разделяются по языкам с помощью папок - `./statements/russian`, `./statements/english` и так далее.

**Лимиты (ограничения по времени и по памяти)** - максимальное время выполнения/использования памяти решения к задаче. TL ставится в миллисекундах, ML - в байтах.

**[[Runner engine|Runner]]** - низкоуровневый движок для запуска процесса с наложенными лимитами в изолированной среде.

**Тест к задаче** - два файла, первый из которых дается во входной поток решению задачи, второй предоставляется чекеру для сверки. Идейно во втором файле находится ответ на тест, но технически это необязательно так - например, в этом файле можно через перенос строки указать возможные правильные ответы, а чекер будет проверять, что программа пользователя вывела один из этих ответов. Вторые файлы тестов могут быть вообще пустыми, если чекер на каждом тесте запускает авторское решение - это неэффективно по времени тестирования посылки, но тоже будет работать.

Формат теста:
- первый файл имеет имя с порядковым номером теста без ведущих нулей
- второй файл имеет имя с порядковым номером теста без ведущих нулей и расширением ".a"

Например:
```bash
.
`-- tests
    |-- 1
    |-- 1.a
    |-- 2
    |-- 2.a
    |-- 3
    `-- 3.a

1 directory, 6 files
```

**Валидатор** - программа, которая валидирует тесты к задаче, то есть проверяет их на соответствие ограничениям. Например, если в тестах есть данные, не соответствующие условию (например, размер входных данных больше ожидаемого, неправильный формат ввода/вывода, валидатор нашел более оптимальный ответ, чем в тесте), то валидатор поможет найти некорректные тесты. На вход валидатору дают 2 файла - то есть содержимое теста.

**Тесты на валидатор** - это тест к задаче, а также ожидаемый вердикт валидатора на нем. Такие тесты нужны, чтобы убедиться, что при валидации тестов не будет ложных срабатываний, а также некорректные тесты не будут пропущены.

**Чекер** - программа, которой на вход дается вывод посылки участника, а также данные теста. Чекер должен выдать вердикт, правильный ответ дало решение или нет. То есть чекер выдает вердикт - либо OK, либо неправильный ответ (WA или PE). Если программа не уложилась в заданные лимиты, чекер не запускается. Обычно не нужно писать свои чекеры, достаточно стандартных - например, чекер на полное соответствие выходного файла программы второму файлу теста. Смотрите список [[Стандартные чекеры Elan|стандартых чекеров]].

**Скорер** - программа, которая получает вердикты решения на всех посылках (список их статусов), и возвращает число - сколько баллов получает эта посылка суммарно. Можно сделать потестовую оценку, указать, сколько баллов дает каждый тест, сделать разграничение по подгруппам (если в подгруппе хотя бы один тест не пройден, за все тесты подгруппы ставится 0), можно сделать что-то совсем кастомное.З

## Формат хранения задачи
Задача в формате Elan хранится в двух местах:
- файловая система
- база данных MongoDB
В файловой системе задача хранится по пути `$ELAN/problems/problem{id}`, где `id` - числовой ID задачи.
### Структура задачи в ФС
#### `problem.json`
В папке с задачей хранится файл `problem.json` такого формата:
```json
{
	"id": 1,
	"short_name": "birthday-mex",
	"languages": ["russian"],
	"runner_config": {
		"time_limit": 10, // миллисекунды
		"memory_limit": 1024, // килобайты
		"allow_write_files": false, // открытие файла для записи
		"allow_read_files": false, // открытие файла для чтения
		"threads_amount": 1, // максимальное число запущенных потоков, разрешенное программе
		"disable_forwarding_std_streams": false, // отключение перенаправления input_file_stream в stdin программы и ее stdout в output_file_stream. Полезно для задач с файловым вводом/выводом
		"input_file_stream": "$ELAN_RUNNER_ENV/input.txt", // файл для stdin
		"output_file_stream": "$ELAN_RUNNER_ENV/output.txt", // файл для stdout
		"working_dir": "$ELAN_RUNNER_ENV", // рабочая директория, сюда можно положить дополнительные файлы (например, testlib.h) и импортировать/линковать их через ".": например, в аргументах для g++ можно указать "-I." - это слинкует все файлы в working_dir. По умолчанию используется $ELAN_RUNNER_ENV - переменная окружения, в которой лежат все файлы для запуска раннера. Физически эта директория лежит в /elan/tmp/<...>
	}
}
```
Обязательный минимум:
```json
{
	"id": 1,
	"short_name": "birthday-mex",
	"languages": ["russian"],
	"runner_config": {
		"time_limit": 10, // миллисекунды
		"memory_limit": 1024, // килобайты
	}
}
```

Можно заметить некоторое сходство объекта `runner_config` с [[Формат тестирования движка runner|форматом тестирования движка runner]]. Действительно, инвокер будет запускать задачи, передавая runner'у параметры из `problem.json`, однако в описании задачи используется упрощенный формат, **не совпадающий** с `runner_assert.json`, который создавался для более специфической задачи.

#### `statements`
Папка с условиями задач. Условия задач лежат отдельно по их языкам. Для каждого языка условием являются от 2 до 7 файлов (см. выше).
MDX - специальный формат, объединяющий JSX и Markdown. Отметим, что Markdown поддерживает Latex, поэтому 4 файла в формате `.tex` из архива Polygon можно просто скопировать в формат Elan, изменив расширения.
Помимо Markdown и Latex, как сказано ранее, MDX поддерживает JSX. JSX - специальный синтаксис, позволяющий писать интерфейс на JS.
Например, валиден такой JSX-код:
```jsx
<button onClick={() => alert("Вы нажали кнопку!")}>
Нажми меня
</button>
```
Использование JSX в условиях задачи позволяет создавать интерактивные примеры, что является **уникальной функцией** тестирующей системы Elan.

Итак, приведем примеры валидных файлов для условия задачи на русском языке:

Файл `./statements/russian/name.mdx`
```mdx
MEX и день рождения
```

Файл `./statements/russian/legend.mdx`
```mdx
На день рождения Алене подарили перестановку $X$ длины $n$. Напомним, что перестановкой является упорядоченный набор из $n$ различных чисел от $1$ до $n$ (например, $\{1, 2, 3\}$ является перестановкой, а $\{1, 2, 4\}$ или $\{1, 2, 2\}$ - не является).

К сожалению, когда Алена оставила свой подарок в комнате без присмотра, к нему подбежала собака Елань и съела одно число.

Помогите Алене восстановить ее перестановку и узнать съеденное число, иначе получите ~тапочком по лицу~ реджект.
```

Файл `./statements/russian/input.mdx`
```mdx
В первой строке дано число $n$ ($0 \lt n \lt 2 * 10^5$). Во второй строке записано $n-1$ число - элементы перестановки $X$ без одного элемента ($0 \lt x_i \lt n + 1$).
```

Файл `./statements/russian/output.mdx`
```mdx
Выведите число, которое съела Елань.
```

